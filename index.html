<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>タイピングゲーム</title>
</head>
<body>
	<h1>タイピングゲーム</h1>
	<hr>
	<p id="navi">スペースキーを押すとスタートします</p>
	<input type="text" id="typearea" disabled="disabled">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script>
		let rndtext=typetext();
		let i;
		let isrunnner=false;
		let starttime;
		$(document).keydown(function(e){
			if((e.keyCode==32||e.keyCode==229)&&!isrunnner){
				isrunnner=true;
				starttime=Date.now();
				$('#navi').text(3);
				i=0;
				setTimeout(function(){
					$('#navi').text(2);
				},1000);
				setTimeout(function(){
					$('#navi').text(1);
				},2000);
				setTimeout(function(){
					$('#navi').text(rndtext);
					$('#typearea').val("").removeAttr('disabled').focus();
				},3000);
			}
			if(e.keyCode==13&&isrunnner){
				if(i<=4) typeJadge(e);
			}
		}).on('paste','#typearea',function(){
			return false;
		});
		function typetext(){
			const textbox=['りんご','ごりら','らっぱ','りぼん','しまね','おふろ'];
			let rndtext=textbox[Math.floor(Math.random()*textbox.length)];
			return rndtext;
		}
		function typeJadge(e){
			if($('#typearea').val()==rndtext){
				$('#typearea').val("");
				rndtext=typetext();
				$('#navi').html((i+1)+"clear!<br>"+rndtext);
				i++;
				if(i>4){
					let mtime=((Date.now()-starttime)/1000).toFixed(2);
					$('#typearea').attr('disabled','disabled');
					$('#navi').html("GAME CLEAR!<br>記録:"+mtime+"秒<br>もういちどスペースキーを押すとリスタート");
					i=0;
					isrunnner=false;
				}
			}
		}
	</script>
</body>
</html>